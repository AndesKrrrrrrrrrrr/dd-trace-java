// Set properties before any plugins get loaded
ext {
  minJavaVersionForTests = JavaVersion.VERSION_1_8
}

apply from: "$rootDir/gradle/java.gradle"
apply plugin: 'scala'

apply plugin: 'org.unbroken-dome.test-sets'
testSets {
  latestDepTest {
    dirName = "test"
  }
}


tasks.named("compileTestGroovy").configure {
  classpath += files(sourceSets.test.scala.classesDirectory)
}

tasks.named("compileLatestDepTestGroovy").configure {
  classpath += files(sourceSets.latestDepTest.scala.classesDirectory)
}

dependencies {
  main_java8CompileOnly deps.scala212
  main_java8CompileOnly group: 'org.http4s', name: 'http4s-blaze-server_2.12', version: '0.21.0'

  testImplementation group: 'org.http4s', name: 'http4s-blaze-server_2.12', version: '0.21.0'
  testImplementation group: 'org.http4s', name: "http4s-dsl_2.12", version: '0.21.0'
  testImplementation project(':dd-java-agent:instrumentation:scala-concurrent')
  testImplementation project(':dd-java-agent:instrumentation:scala-promise:scala-promise-2.10')

  latestDepTestImplementation group: 'org.http4s', name: 'http4s-blaze-server_2.12', version: '0.21.+'
  latestDepTestImplementation group: 'org.http4s', name: "http4s-dsl_2.12", version: '0.21.+'
}
