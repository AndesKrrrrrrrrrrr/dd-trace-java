plugins {
  id "com.github.johnrengelman.shadow"
}

apply from: "$rootDir/gradle/java.gradle"
apply from: "$rootDir/gradle/version.gradle"

dependencies {
  api deps.slf4j
  api project(':internal-api')
  api project(':dd-java-agent:agent-tooling')

  testImplementation deps.bytebuddy
  testImplementation project(':utils:test-utils')
}

configurations {
  // exclude bootstrap dependencies from shadowJar
  runtime.exclude module: deps.slf4j
  runtime.exclude group: 'org.slf4j'
}

shadowJar {
  dependencies deps.sharedInverse
  dependencies {
    exclude(project(':dd-java-agent:agent-bootstrap'))
    exclude(project(':dd-java-agent:agent-logging'))
    exclude(project(':dd-java-agent:agent-tooling'))
    exclude(project(':dd-trace-api'))
    exclude(project(':internal-api'))
    exclude(project(':internal-api:internal-api-8'))
    exclude(project(':utils:socket-utils'))
    exclude(dependency('org.slf4j::'))
  }
}

jar {
  archiveClassifier = 'unbundled'
}
